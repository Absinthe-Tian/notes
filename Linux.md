## 基本知识

### 文件类型

| 类型 | 说明         |
| ---- | ------------ |
| -    | 普通文件     |
| d    | 目录         |
| l    | 符号链接文件 |
| c    | 字符设备文件 |
| b    | 块设备文件   |
| s    | 套接字文件   |
| p    | 管道文件     |



### 文件权限

| 权限 | 说明         | rwx  | 二进制 | 十进制 |
| ---- | ------------ | ---- | ------ | ------ |
| r    | 表示读取权限 | r--  | 100    | 4      |
| w    | 表示写入权限 | -w-  | 010    | 2      |
| x    | 表示执行权限 | --x  | 001    | 1      |
| -    | 表示没有权限 | ---  | 000    | 0      |



## 基本命令

### 说明书

```bash
man 命令
```



### 帮助

```bash
命令 --help
```



### 关机重启

```bash
shutdown 参数 [时间]
```

| 参数 | 说明             |
| ---- | ---------------- |
| -h   | 停止CPU          |
| -r   | 重启，同`reboot` |
| -c   | 取消关机计划     |



## 目录管理

### 创建目录

```bash
mkdir 参数 目录
```

| 参数 | 说明         |
| ---- | ------------ |
| -p   | 不存在则创建 |



### 删除目录

```bash
rmdir 参数 目录
```

> 要求目录为空。

| 参数 | 说明                                 |
| ---- | ------------------------------------ |
| -p   | 删除子目录使父目录为空，则删除父目录 |



### 改变工作目录

```bash
cd 目录
```

注意：区分绝对路径和相对路径。



### 列表查看

```bash
ls [参数] [.|目录]
```

| 参数 | 说明                                                   |
| ---- | ------------------------------------------------------ |
| -a   | 显示所有文件及目录（包含隐藏）                         |
| -d   | 仅显示目录                                             |
| -l   | 显示文件及目录信息（类型、权限、持有者、大小、创建时间 |
| -r   | 倒序显示文件及目录                                     |
| -t   | 时间排序显示文件及目录                                 |
| -R   | 递归显示目录中的所有文件和子目录                       |

在使用 `-l`参数时，共7列，其中

第1列表示文件及目录的**类型**和**权限**。第1位表示类型，第2-4位表示用户权限（owner）、第5-7位表示用户组权限（group）、第8-10位表示其他权限（others）。

第2列表示链接数。

第3列表示拥有者。

第4列表示所属组。

第5列表示字节大小。

第6列表示修改时间。

第7列表示名称。



### 树状查看

```bash
tree 参数 目录
```

| 参数 | 说明               |
| ---- | ------------------ |
| -L   | 指定目录深度       |
| -d   | 仅显示目录         |
| -f   | 显示完整路径       |
| -a   | 显示所有文件及目录 |



### 查看工作目录

```bash
pwd
```



## 文件管理

### 创建文件

```bash
touch 参数 文件s
```

| 参数 | 说明             |
| ---- | ---------------- |
| -d   | 设定文件日期时间 |



### 重定向创建

```bash
cat > 文件
```

> 回车、输入内容、Ctrl + D。



```bash
echo '内容' [>|>>] 文件
```

> `>`：覆盖内容。
>
> `>>`：追加内容。



### 复制文件

```bash
cp 参数 路径 路径
```

| 参数  | 说明                     |
| ----- | ------------------------ |
| -i    | 逐个提示确认             |
| -r/-R | 递归复制                 |
| -v    | 详细模式                 |
| -p    | 保留文件属性             |
| -a    | 归档复制（保留原始状态） |



### 移动文件

```bash
mv 参数 路径 路径
```

| 参数 | 说明                   |
| ---- | ---------------------- |
| -b   | 覆盖已有路径并创建备份 |
| -i   | 逐个提示确认           |
| -n   | 不覆盖已有路径         |
| -u   | 更新                   |



### 删除文件

```bash
rm 参数 路径
```

| 参数 | 说明         |
| ---- | ------------ |
| -i   | 逐个提示确认 |
| -f   | 强制删除     |
| -r   | 递归删除     |



### 查看属性

```bash
file 文件
```



### 全部查看

```bash
cat 参数 文件
```

| 参数 | 说明                       |
| ---- | -------------------------- |
| -n   | 显示所有行号（包含空行）   |
| -b   | 显示非空行号（不包含空行） |
| -s   | 压缩连续的空行             |
| -E   | 显示文件结束符 `$`         |
| -T   | 转义制表符为 `^I`          |



### 分页查看

```bash
more 文件
```

> 加载慢，回车逐行，空格下翻，`b`上翻， `q`退出。



```bash
less 文件
```

> 加载快，`j`、`k`可下上翻动。



### 部分查看

```bash
head 参数 N 文件
```

> 头部查看。

| 参数 | 说明          |
| ---- | ------------- |
| -n   | 显示前N行内容 |
| -c   | 显示前N个字节 |



```
tail 参数 N 文件
```

> 尾部查看。

| 参数 | 说明                   |
| ---- | ---------------------- |
| -n   | 显示后N行内容          |
| -c   | 显示后N个字节          |
| -f   | 跟踪追加内容           |
| -s   | 跟踪睡眠时间（默认1s） |



### 比较文件

```bash
diff 参数 文件 文件
```

| 参数 | 说明                               |
| ---- | ---------------------------------- |
| -u   | 统一格式输出                       |
| -w   | 忽略空格差异                       |
| -r   | 比较目录差异                       |
| -q   | 仅显示文件是否不同，不显示具体差异 |



### 查找文件

```bash
find 路径 参数 内容
```

> 查找指定目录符合条件的文件。

| 参数  | 说明                          |
| ----- | ----------------------------- |
| -name | 按文件名查找（`*`通配符）     |
| -type | 按类型查找                    |
| -size | 按大小查找（`+N`、`-N`        |
| -perm | 按权限查找（`ugo`或者十进制） |



```bash
whereis 文件
```

> 查找二进制文件、源代码文件和帮助文档。



```bash
which 文件
```

> 查找系统环境变量`PATH`中的可执行文件。



### 压缩解压

```bash
# 打包
tar -cvf 文件包名.tar 路径s
# 解包
tar -xvf 文件包.tars [-C 路径]

# 压缩
zip -r 文件包名.zip 路径s
# 解压
unzip 文件包文件包名.zips

# 压缩
tar -zcvf 文件包名.tar.gz 路径s
# 解压
tar -zxvf 文件包名.tar.gzs
```



### 软硬链接

```bash
ls 参数 原文件 链接名
```

| 参数 | 说明       |
| ---- | ---------- |
| -s   | 创建软链接 |

> 硬链接：通过索引节点（inode）实现。（数据共享、不能跨文件系统、不能链接目录）。
>
> 软链接：指向另一个文件或目录的路径信息。（相对独立、可以跨文件系统、可以链接目录）。



### 文件传输

```bash
rcp 参数 路径 路径
```

> 用于复制远程文件和目录。

| 参数 | 说明     |
| ---- | -------- |
| -p   | 保留属性 |
| -r   | 递归处理 |



```bash
scp 参数 路径 路径
```

> 用于Linux之间加密复制文件和目录。
>
> 服务器路径：`username@IP:path`或者`IP:path`。

| 参数 | 说明     |
| ---- | -------- |
| -C   | 允许压缩 |
| -P   | 指定端口 |
| -r   | 递归传输 |



```bash
ftp IP
```

> 建立文件传输连接。

```bash
get [-r] 文件
put [-r] 文件
```

> 下载和上传文件。



```bash
sftp IP
```

> 建立加密文件传输连接。



```bash
wget 参数 URL
```

> 下载URL的文件。

| 参数 | 说明                          |
| ---- | ----------------------------- |
| -O   | 文件重命名                    |
| -b   | 后台下载                      |
| -c   | 断点续传                      |
| -i   | 多文件下载（配合文件URL列表） |



```bash
curl 参数 URL
```

> 将URL内容输出到终端。

| 参数 | 说明             |
| ---- | ---------------- |
| -o   | 指定文件进行保存 |



## 用户管理

### 添加用户

```bash
useradd 参数 用户名
```

| 参数 | 说明           |
| ---- | -------------- |
| -m   | 创建用户主目录 |
| -s   | 指定默认shell  |



### 删除用户

```bash
userdel 参数 用户名
```

| 参数 | 说明                   |
| ---- | ---------------------- |
| -r   | 删除用户主目录和邮件池 |



### 修改属性

```bash
usermod 参数 用户名
```

| 参数 | 说明           |
| ---- | -------------- |
| -g   | 修改用户所属组 |
| -aG  | 添加附加组     |



### 修改密码

```bash
passwd 参数 用户名
```

| 参数 | 说明                   |
| ---- | ---------------------- |
| -l   | 锁定用户，使其无法登录 |
| -u   | 解锁用户               |
| -d   | 删除密码               |



### 切换用户

```bash
su 用户名

# 退出当前用户
exit
```



## 用户组管理

### 添加用户组

```bash
groupadd 组名
```



### 删除用户组

```bash
groupdel 组名
```



### 修改属性

```bash
groupmod 参数 组名
```

| 参数 | 说明      |
| ---- | --------- |
| -n   | 修改组名  |
| -g   | 设置组GID |



### 修改密码

```bash
gpasswd 参数 组名
```

| 参数 | 说明         |
| ---- | ------------ |
| -a   | 添加用户到组 |
| -d   | 从组删除用户 |
| -A   | 指定管理员   |
| -r   | 删除密码     |



## 权限管理

### 修改权限

```bash
chmod 参数 权限 路径
```

> 权限数字表示法：777
>
> 权限符号表示法：`u+rwx`、`g-x`、`o=---`
>
> 即 `+`添加权限、`-`移除权限、`=`赋值权限。

| 参数 | 说明     |
| ---- | -------- |
| -R   | 递归修改 |



### 修改所属者

```bash
chown [-R] 用户[:组名] 路径
```



### 修改所属组

```bash
chgrp [-R] 组名 路径
```



### 设置默认权限

```bash
umask 掩码值
```



## 进程管理

### 查看进程

```bash
ps 参数
```

| 参数 | 说明              |
| ---- | ----------------- |
| -ef  | 显示所有进程信息  |
| -aux | 显示CPU等更多细节 |



### 动态显示

```bash
top 参数
```

| 参数 | 说明                      |
| ---- | ------------------------- |
| -d   | 指定刷新秒数              |
| -n   | 指定刷新次数后退出        |
| -p   | 仅显示指定进程ID的进程    |
| -u   | 仅显示指定用户名的进程    |
| -i   | 不显示闲置或无用的进程    |
| -S   | 累计显示进程的CPU使用时间 |



### 终止进程

```bash
kill 参数 进程ID
```

| 参数        | 说明             |
| ----------- | ---------------- |
| `-<signal>` | -9，强制终止     |
| -l          | 列出所有可用信号 |



### 不挂断运行

```bash
nohup 服务 > 日志.log 2>&1 &
```

>  **2>&1** 解释：
>
> 将标准错误 2 重定向到标准输出 &1 ，标准输出 &1 再被重定向输入到 日志文件。
>
> - 0 – stdin (standard input，标准输入)
> - 1 – stdout (standard output，标准输出)
> - 2 – stderr (standard error，标准错误输出)



## 网络管理

### 测试连通性

```bash
ping 参数 IP
```

| 参数 | 说明             |
| ---- | ---------------- |
| -c   | 发送数据包的次数 |



### 查看网口信息

需安装`net-tools`。

```bash
ifconfig
```

> 查看和配置网络接口信息。



```bash
netstat 参数
```

> 显示网络连接、路由表、端口统计等网络相关信息

| 参数   | 说明                   |
| ------ | ---------------------- |
| -a     | 查看所有网络连接信息   |
| -p     | 显示PID                |
| -tunlp | 查看所有端口及进程信息 |
| -r     | 查看路由表信息         |



```bash
lsof -i:端口
```

> 查看指定端口对应的进程信息。



```bash
ss -tunlp
```

> 查看指定端口对应的进程信息。



需安装`iproute2`。

```bash
ip [命令] [选项] [参数]
```

> 网络配置工具。



### 开关端口

CentOS系统，需要安装`firewalld`。

```bash
# 开放
firewall-cmd --add-port=3306/tcp --permanent
# 关闭
firewall-cmd --remove-port=3306/tcp --permanent
# 重载
firewall-cmd --reload
```



Debian系统。

```bash
# 开放
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
# 关闭
iptables -A INPUT -p tcp --dport 80 -j DROP
# 保存
iptables - save > /etc/iptables/rules.v4
```

> 也可使用`ufw`。



### 配置映射

`/etc/hosts`添加

```bash
IP HostName
```

> 使用 HostName 时会映射到该 IP。



## 系统管理

### 查看系统信息

```bash
uname 参数
```

| 参数 | 说明             |
| ---- | ---------------- |
| -a   | 显示所有系统信息 |
| -r   | 仅显示内核版本   |



### 修改主机名

```bash
hostnamectl set-hostname 主机名
```



### 别名

```bash
# 添加
alias [别名=指令]
# 删除
unalias [-a]
```

> 若不指定，则展示所有的别名。



### 查看磁盘空间

```bash
df 参数
```

| 参数 | 说明             |
| ---- | ---------------- |
| -h   | 以可读形式显示   |
| -T   | 显示文件系统类型 |



### 查看路径占用

```bash
du 参数 路径
```

| 参数 | 说明                             |
| ---- | -------------------------------- |
| -sh  | 以可读形式显示                   |
| -a   | 显示所有文件和目录的磁盘占用情况 |



### 查看内存占用

```bash
free 参数
```

| 参数 | 说明                           |
| ---- | ------------------------------ |
| -m   | 以MB为单位显示                 |
| -g   | 以G为单位显示                  |
| -t   | 末行输出汇总（内存和交换空间） |



### 系统日期

```bash
date 参数
```

| 参数 | 说明                                     |
| ---- | ---------------------------------------- |
| 格式 | 指定输出格式，如 `+%Y-%m-%d %H:%M:%S`    |
| -s   | 设置系统时间，如 `"2024-11-04 18:00:00"` |



### 软件管理

在使用 Docker 创建 CentOS 8时使用`docker run -d --name centos8 --privileged centos/systemd:latest`。

CentOS 8 已停止更新，会导致 appstream 下载元数据失败。

解决：

```bash
cd /etc/yum.repos.d/

sed -i 's/mirrorlist/#mirrorlist/g' /etc/yum.repos.d/CentOS-*
sed -i 's|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g' /etc/yum.repos.d/CentOS-*

yum clean all && yum makecache && yum update -y
```



```bash
# 列表
yum list 软件包
# 搜索
yum search 软件包
# 安装
yum install 软件包
# 更新
yum update 软件包
# 卸载
yum remove 软件包
```

> CentOS系统自带的软件管理。



```bash
# 更新源
apt-get update
# 搜索
apt-get search 软件包
# 更新软件
apt-get upgrade 软件包
# 安装软件
apt-get install 软件包
# 卸载软件
apt-get remove 软件包
```

> Debian系统自带的软件管理



```bash
# 安装
rpm -ivh 软件包
# 更新
rpm -uvh 软件包
# 卸载
rpm -ev 软件包
```

> 对于 rpm 格式的软件包管理。



### 防火墙及服务

```bash
# 查看|开启|停止|重启
service iptables status|start|stop|restart
```

> 临时设置，此处是防火墙服务，其他服务同理。



```bash
# 状态|自启|非自启|启动|停止|重启
systemctl status|enable|disable|start|stop|restart iptables
```

> 用途广泛。



| Sysvinit command             | Systemd command                |
| ---------------------------- | ------------------------------ |
| service service_name start   | systemctl start service_name   |
| service service_name stop    | systemctl stop service_name    |
| service service_name restart | systemctl restart service_name |
| service service_name status  | systemctl status service_name  |
| chkconfig service_name on    | systemctl enable service_name  |
| chkconfig service_name off   | systemctl disable service_name |

> 出现 service: command not found错误，即 `initscripts`损坏，重新下载即可。



## 挂载

### 查看分区信息

```bash
fdisk -l
```



### 获取设备属性

```bash
blkid
```



### 挂载

```bash
mount 设备名 挂载点

mount UUID="xxx-xxx-xxx-xxx" 挂载点
```

> 挂载点一般位于 `/mnt`目录下。



### 卸载

```bash
umount 设备名|挂载点
```



### 自启挂载

`/etc/fstab`添加

```bash
UUID = "xxx-xxx-xxx-xxx-xxx" 挂载点   ext4|NTFS    defaults    0    0
```

